- 需求，使用矩阵按键顺序，在数码管显示数字5-20
- 要考虑的问题
	- 占用引脚过多问题
	- 矩阵按键检测问题，弱上拉，强下拉
	- 长按按键时，最后一个数码管亮度问题
		- 长按时，循环阻塞
		- 上一次的最后一个数码管就一直亮着
# 占用引脚过多问题
![](../photo/Pasted%20image%2020250815153700.png)
# 矩阵按键检测问题

弱上拉，强下拉
![](../photo/Pasted%20image%2020250815154439.png)
```
u8 Int_MatrixKey_CheckKey()
{
    //    P24 P25 P26 P27
    // P20 +---+---+---+
    // P21 +---+---+---+
    // P22 +---+---+---+
    // P23 +---+---+---+

    // 扫描第一行，将P20置0，其余置1；P27-P20依次为：1111 1110
    P2 = 0xFE;
    // 检测第SW5是否被按下，若被按下，P24会被拉低，P27-P20依次为：1110 1110
    if (P2 == 0xEE) {  // 等价于 P24 == 0
        Delay1ms(10);
        if (P2 == 0xEE) {
            while (P2 == 0xEE);
            return 5;
        }
    }
    。。。
    return 0;
}
```